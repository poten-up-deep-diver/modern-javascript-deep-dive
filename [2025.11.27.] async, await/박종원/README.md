# async, await

## 동기, 비동기가 뭘까?

동기라는 말은 일상에서 자주 쓰입니다.

- **지원동기**의 동기
- **동기부여**의 동기
- **입사동기**의 동기
- **동기화**의 동기
- ~~점멸, 비전이동 같은 이동기의 동기~~

동기화의 사전적 의미는 '같은 시기에 맞추어 일어남' 이라는 뜻을 가지고 있습니다.
즉 자바스크립트에서 동기적 액션이란 "내 작업이 끝나면 다음 작업을 맞춰서 바로 진행시켜줘" 라는 뜻입니다.

동기와 비동기를 예제로 설명하면 다음과 같습니다.

- **동기**

  - 직원이 커피 주문을 받는다.
  - 해당 직원이 커피를 만든다.
  - (고객은 직원이 커피를 줄때까지 기다린다)
  - 커피를 다 만들면 해당 직원이 해당 고객에게 커피를 준다.
  - 다음 고객을 받는다.

- **비동기**
  - 직원이 커피 주문을 받는다.
  - 해당 직원이 고객에게 진동벨을 준다.
  - (고객은 직원이 진동벨로 호출하기 전까지 다른 장소에서 기다린다)
  - **다음 손님을 받거나 커피를 받는다.**
  - 커피를 다 만들면 해당 직원이 해당 고객에게 커피를 준다.

## 동기 방식이란?

동기 방식은 코드가 작성된 순서대로 하나씩 실행되는 방식입니다. 하나의 작업이 완전히 끝나기 전까지 다음 작업을 시작하지 않습니다.

**특징**

- 순차적 실행 : 코드가 위에서 아래로 순차적으로 실행합니다.
- 블로킹 : 특정 작업이 끝나기 전까지 다음 코드로 넘어가지 못합니다.
- 예측 쉬움 : 순차적으로 실행되고, 특정 작업이 끝나기 전까지 다음 코드로 넘어가지 않기 때문에 흐름을 예측하기 쉽습니다.

## 비동기 방식이란?

작업이 끝날 때까지 기다리지 않고 바로 당므 코드를 실행하는 방식입니다. 시간이 오래 걸리는 작업은 일단 요청만 보내두고, 그 작업이 완료되면 결과를 받아 처리합니다.

**특징**

- 비순차적 실행 : 코드 순사와 실제 실행 순서가 다를 수 있습니다.
- 논블로킹 : 시간이 오래 걸리는 작업을 기다리는 동안 다른 작업을 계속 수행할 수 있어 효율적입니다.
- 응답성 향상 : 서버에 데이터를 요청하고 기다리는 동안 UI가 멈추지 않아 사용자 경험이 좋아집니다.

## Promise

Promise의 뜻은 '약속' 입니다. 그런데 자바스크립트에서는 왜 비동기 작업의 결과 값을 나타내는 객체를 Promise라고 부를까요?

미래의 어떤 시점에 결과를 제공하겠다는 '약속'의 의미로 자바스크립트에서 비동기 작업이 Promise가 되었습니다.

Promise는 생성된 순간부터 다음 중 하나의 상태를 가지게 됩니다.

- **Pending(대기)** : 비동기 작업이 아직 완료되지 않은 초기 상태
- **Fulfilled(완료)** : 약속(Promise)된 값을 가지게 된 상태
- **Rejected(거부)** : 비동기 작업을 실패한 상태. 이때 reject 함수 호출식의 error가 이유를 갖게 됩니다.

## 간단하게 알아보는 이벤트 루프

- 콜 스택(call stack) : console.log(), 변수 할당 등 **실행과 동시에 수행되는 것**
- 테스크 큐(task queue) : 비동기 작업의 콜백함수, 브라우저 API 등
  - 매크로 테스크 (macro task) : 테스크 큐에 올라오는 거의 모든 것
  - 마이크로 테스크 (micro task) : 테스크 큐에 올라오는 것 중 **우선순위**가 높은 것 (setInterval, setTimeout 등)

> 테스크 큐는 콜 스택이 끝난 후 실행합니다.

> 마이크로 테스크는 매크로 테스크와 다르게 콜 스택 출력 중에도 즉각적으로 반환(출력)할 수 있습니다.

## async, await

일반적인 Promise로 비동기 작업을 하게 될 경우, 콜백 혹은 then 체인으로 사용해서 콜백 (중첩)지옥이 만들어져 코드의 가독성을 해쳤습니다.

그것을 개선하기 위해 async, await이 나와 보다 깔끔한 코드 작성을 유지할 수 있게 해줬고, catch로 받아 콜백 지옥에 빠지게 되면 관리하기 어렵던 예외 처리도 try-catch로 깔끔하게 유지할 수 있게 되었습니다.

## 정리

> "동기와 비동기는 기다림의 차이"

즉 결정적인 속도의 차이가 아닌, 효율의 차이가 동기와 비동기의 차이입니다.

Promise의 콜백지옥을 해결하기 위해 async, await이 생겼습니다.
